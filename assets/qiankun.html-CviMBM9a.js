import{_ as s,c as a,b as e,o as p}from"./app-CHQcNXY0.js";const t={};function l(i,n){return p(),a("div",null,n[0]||(n[0]=[e(`<h4 id="q-父应用和子应用可以在不同的nginx上吗" tabindex="-1"><a class="header-anchor" href="#q-父应用和子应用可以在不同的nginx上吗"><span>Q：父应用和子应用可以在不同的nginx上吗？</span></a></h4><p>A：可以，父子应用既可以在同一个nginx也可以在不同的nginx上。</p><h4 id="q-从slb-服务器-过来的请求是先到父应用再路由到子应用" tabindex="-1"><a class="header-anchor" href="#q-从slb-服务器-过来的请求是先到父应用再路由到子应用"><span>Q：从SLB(服务器)过来的请求是先到父应用再路由到子应用？</span></a></h4><p>A：不是。 父应用在运行时，通过fetch拿到子应用的html文件上的js、css依赖（import-html-entry），划出一个&quot;独立容器&quot; （sandbox）运行子应用，所有子应用都是运行在父应用这个基座上的&quot;应用级组件&quot; ，子应用成为了父应用的一部分，子应用中配置的的代理不会生效，父子应用共享同一个网络环境，都运行在同一个IP上，请求都从同一个IP发出，⼦应⽤的所有⽹络请求都通过⽗应⽤配置的代理转发。</p><h4 id="q-父应用和子应用通信-是不是通过网络通信" tabindex="-1"><a class="header-anchor" href="#q-父应用和子应用通信-是不是通过网络通信"><span>Q：父应用和子应用通信？（是不是通过网络通信）</span></a></h4><p>A：qiankun的父子应用通信不是通过网络通信</p><p>父子应用通信是直接通过浏览器存储或者内存等。例如路由参数、localStorage、eventBus或者线程的全局状态管理工具都可以管理（比如umi的useModel）</p><p>⼦应⽤挂载时，也可以类似 React 组件通过 props 传递具体数据和⽗应⽤中改变数据的函数，也可以 传递⼀个全局状态，其包含变量修改和监听变化的函数，⽗⼦应⽤都可以监听变量的变化和修改变 量。</p><h4 id="nginx配置" tabindex="-1"><a class="header-anchor" href="#nginx配置"><span>Nginx配置</span></a></h4><p>父应用上的nginx配置类似本地文件中的proxy代理配置，在父应用上分别配置每个子应用的html文件所在的地址（资源代理），和子应用的后端接口地址（请求代理）。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;/root-app&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;https://xxx.xxx.com:xxxx/&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token comment">// child1 </span></span>
<span class="line">    <span class="token comment">// 资源代理 </span></span>
<span class="line">    <span class="token string-property property">&quot;/child1/&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;https://xxx.xxx.com:xxxx/&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token comment">// 接⼝代理 </span></span>
<span class="line">    <span class="token string-property property">&quot;/child1-api/&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;https://xxx.xxx.com:xxxx/&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token comment">//......</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>不允许主应用跨域访问微应用</strong>，做法就是将主应⽤服务器上⼀个特殊路径的请求全部转发到微应⽤的 服务器上，即通过代理实现“微应⽤部署在主应⽤服务器上”的效果。</p><p>例如，主应⽤在 A 服务器，微应⽤在 B 服务器，使⽤路径 /app1 来区分微应⽤，即 A 服务器上所有 /app1 开头的请求都转发到 B 服务器上。此时主应⽤的 Nginx 代理配置为：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">/app1/ {</span>
<span class="line"> proxy_pass http://www.b.com/app1/; </span>
<span class="line"> proxy_set_header Host $host:$server_port;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14)]))}const c=s(t,[["render",l]]),r=JSON.parse('{"path":"/common/qiankun.html","title":"","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1765270819000,"contributors":[{"name":"zhangcheng","username":"zhangcheng","email":"2778162192@qq.com","commits":1,"url":"https://github.com/zhangcheng"}],"changelog":[{"hash":"ca4510f9956c8477f66046cf6cce4cda559bf824","time":1765270819000,"email":"2778162192@qq.com","author":"zhangcheng","message":"commit"}]},"filePathRelative":"common/qiankun.md"}');export{c as comp,r as data};
